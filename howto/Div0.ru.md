# Div0
## Об этом документе
Это страница с инструкциями к Div0 v1.0.0

Убедись что версии в эффекте и в документе совпадают.

Если ты отсканировал(а) QR код, то все тип-топ, в каждый релиз вшита соответствующая ссылка.

Если ты открыл(а) эту страницу вручную, и версии не совпадают, нужно найти tag который подходит к твоей версии. Нужная менюшка обычно находится сверху слева от документа. По умолчанию там написано что-то типа `main`. Если на нее нажать, появятся варианты `Branches` и `Tags`. Выбираешь `Tags`, выбираешь из Div0 нужную версию.

## Об эффекте
Этот эффект позволяет другим эффектам иметь доступ к Сухим Левому и Правому каналам, отдельно. Без него, Сухой Левый это сумма Левого и Правого, а Сухой Правый пуст.

Добавь этот эффект к прошивке CDR, поставь его первым. Положение ручек и кнопки подбирай экспериментально, в зависимости от эффектов в цепи. Каждый эффект, для которого нужен Div0, должен иметь в описании рекомендуемые настройки.

## Технические детали
Для интересующихся, вот несколько диаграмм.

Для начала, как работают три буфера в оригинале:

<img src="base.png">

Буфер Эффектов содержит 8 сэмплов Левого канала, затем 8 сэмплов Правого канала, за одно и то же время.

Сухой буфер содержит 8 сэмплов суммы Левого и Правого, и 8 сэмплов тишины.

Выходной буфер содержит 8 сэмплов Левого канала, затем 8 сэмплов Правого канала, за одно и то же время.

Как я понимаю, по умолчанию, каждый эффект читает буфер Эффектов, применяет к нему свою функцию, и пишет в буферы Эффектов и Выходной. Сухой буфер используется как вспомогательный, например, как один из вариантов источника огибающей для `ZNR`.

Эффекты не выключаются "по-настоящему", вместо этого они просто не применяют свою функцию. Как я помню, так реализована опция "сохранять хвосты". Когда она включена, эффект просто выдает хвосты, но не применяет функцию к сигналу.

Другое важное замечание — это то, что буферы переиспользуются, или работают как будто так и есть. Это значит, что каждый эффект по очереди модифицирует буферы Эффектов и Выходной, а не обрабатывает их как "цепочку".

Стопэ, что ты там говорил про 8 сэмплов суммы и тишину...

<img src="question.png">

Агась. Я думаю для совместимости между примочками со Стерео и Моно входами, и эффектами на них, Левый и Правый каналы суммируют и пихают туда, где должен быть левый, а правый для равновесия оставляют в тишине. Даже место под правый канал есть, я его использую тут и ничего, работает.

Зочем так сделали, я не знаю, но из-за этого эффекты не могут получить доступ к Левому и Правому каналам Сухого по отдельности.

Div0 как раз это и чинит:

<img src="div0.png">

Выходной буфер даже не трогает, не нужно. Экономит CPU.

Работает только с буферами Эффектов и Сухим.

На буфер Эффектов применяет соответствующую крутилку громкости. Это позволяет заглушить канал для следующего эффекта, если поставить крутилку в 0.

На Сухом буфере, для Левого канала, функция зависит от состояния Div0:
  * Когда эффект включен (Светодиод горит) Левый канал буфера Эффектов записывается на Левый канал Сухого буфера. Это позволяет "протащить" Левый канал в чистом виде для других эффектов.
  * Когда эффект выключен (Светодиод не горит) на место Левого канала в Сухом буфере пишется тишина. Это запасной вариант, на случай если эффект дальше подмешивает его в сигнал.

На Сухом буфере, Правый канал просто перезаписывается буфером Эффектов. Это значит, что когда  Div0 стоит первым в цепочке, на место тишины пишется чистый Правый канал.

Итого, Div0 позволяет относительно надежно передать следующим эффектам чистые Левый и Правый каналы по Сухому буферу.
